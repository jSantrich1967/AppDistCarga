<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Plantilla Excel - Actas de Despacho</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; }
        .btn { background: #28a745; color: white; padding: 12px 24px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        .btn:hover { background: #218838; }
        .info { background: #e8f4f8; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .warning { background: #fff3cd; padding: 15px; border-radius: 8px; margin: 15px 0; color: #856404; }
        h1, h2 { color: #495057; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; font-size: 12px; }
        th { background: #28a745; color: white; }
        .required { background: #ffe6e6; }
        .optional { background: #e6f7ff; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Plantilla Excel - Actas de Despacho</h1>
        
        <div class="info">
            <h3>üìã Instrucciones:</h3>
            <ul>
                <li>Descarga la plantilla Excel haciendo click en el bot√≥n</li>
                <li>Llena los datos en las columnas correspondientes</li>
                <li>Solo <strong>Fecha, Ciudad y Agente</strong> son obligatorios</li>
                <li>Cada fila se convertir√° en una acta independiente</li>
                <li>Guarda el archivo y s√∫belo en la aplicaci√≥n</li>
            </ul>
        </div>

        <button class="btn" onclick="generarPlantilla()">
            üì• Descargar Plantilla Excel Completa
        </button>

        <div class="warning">
            <strong>üí° Tip:</strong> Los nombres de columnas son flexibles. Puedes usar "Fecha" o "Date", "Ciudad" o "City", etc.
        </div>

        <h2>üìã Estructura de la Plantilla:</h2>
        
        <table>
            <thead>
                <tr>
                    <th>Columna</th>
                    <th>Descripci√≥n</th>
                    <th>Ejemplo</th>
                    <th>Requerida</th>
                </tr>
            </thead>
            <tbody>
                <tr class="required">
                    <td><strong>Fecha</strong></td>
                    <td>Fecha del acta</td>
                    <td>2024-12-25</td>
                    <td>‚úÖ S√ç</td>
                </tr>
                <tr class="required">
                    <td><strong>Ciudad</strong></td>
                    <td>Ciudad de destino</td>
                    <td>Miami</td>
                    <td>‚úÖ S√ç</td>
                </tr>
                <tr class="required">
                    <td><strong>Agente</strong></td>
                    <td>Nombre del agente/cliente</td>
                    <td>Juan P√©rez</td>
                    <td>‚úÖ S√ç</td>
                </tr>
                <tr class="optional">
                    <td>Modelo Camion</td>
                    <td>Modelo del veh√≠culo</td>
                    <td>Freightliner</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>A√±o Camion</td>
                    <td>A√±o del veh√≠culo</td>
                    <td>2020</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>Placa</td>
                    <td>Placa del veh√≠culo</td>
                    <td>ABC-123</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>Chofer</td>
                    <td>Nombre del conductor</td>
                    <td>Carlos L√≥pez</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>Telefono Chofer</td>
                    <td>Tel√©fono del conductor</td>
                    <td>555-1234</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>Ayudante</td>
                    <td>Nombre del ayudante</td>
                    <td>Mar√≠a Gonz√°lez</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>Telefono Ayudante</td>
                    <td>Tel√©fono del ayudante</td>
                    <td>555-5678</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>No Guia</td>
                    <td>N√∫mero de gu√≠a</td>
                    <td>G001-2024</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>Cliente</td>
                    <td>Nombre del cliente final</td>
                    <td>Empresa XYZ</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>Direccion</td>
                    <td>Direcci√≥n de entrega</td>
                    <td>Calle 123, Miami FL</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>Telefono</td>
                    <td>Tel√©fono del cliente</td>
                    <td>305-555-9999</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>Bultos</td>
                    <td>Cantidad de bultos</td>
                    <td>5</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>Pies</td>
                    <td>Pies c√∫bicos</td>
                    <td>15.5</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>Kgs</td>
                    <td>Peso en kilogramos</td>
                    <td>30</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>Via</td>
                    <td>Tipo de env√≠o</td>
                    <td>maritimo</td>
                    <td>‚ùå No</td>
                </tr>
                <tr class="optional">
                    <td>Subtotal</td>
                    <td>Monto por gu√≠a</td>
                    <td>45.75</td>
                    <td>‚ùå No</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        function generarPlantilla() {
            // Crear datos de la plantilla
            const headers = [
                'Fecha', 'Ciudad', 'Agente', 'Modelo Camion', 'A√±o Camion', 'Placa', 
                'Chofer', 'Telefono Chofer', 'Ayudante', 'Telefono Ayudante',
                'No Guia', 'Cliente', 'Direccion', 'Telefono', 'Bultos', 'Pies', 'Kgs', 'Via', 'Subtotal'
            ];

            const ejemplos = [
                [
                    '2024-12-25', 'Miami', 'Juan P√©rez Garc√≠a', 'Freightliner Cascadia', '2020', 'ABC-123',
                    'Carlos L√≥pez', '555-1234', 'Mar√≠a Gonz√°lez', '555-5678',
                    'G001-2024', 'Empresa XYZ S.A.', 'Calle 123, Miami FL 33101', '305-555-9999', '5', '15.5', '30', 'maritimo', '45.75'
                ],
                [
                    '2024-12-26', 'New York', 'Ana Rodr√≠guez', 'Volvo VNL', '2021', 'XYZ-789',
                    'Roberto Silva', '555-2468', 'Carmen Ruiz', '555-1357',
                    'G002-2024', 'Comercial ABC', 'Avenida 456, NY 10001', '212-555-8888', '3', '8.2', '20', 'aereo', '32.50'
                ],
                [
                    '2024-12-27', 'Los Angeles', 'Luis Mendoza', 'Peterbilt 579', '2019', 'DEF-456',
                    'Elena Torres', '555-3579', 'Diego Morales', '555-2468',
                    'G003-2024', 'Distribuidora LA', 'Boulevard 789, LA 90210', '323-555-7777', '8', '22.1', '45', 'maritimo', '68.25'
                ]
            ];

            // Crear hoja de instrucciones
            const instrucciones = [
                ['PLANTILLA PARA IMPORTACI√ìN DE ACTAS DE DESPACHO'],
                [''],
                ['INSTRUCCIONES:'],
                ['1. Llena los datos en la hoja "Actas" (ver pesta√±a abajo)'],
                ['2. Solo Fecha, Ciudad y Agente son obligatorios'],
                ['3. Cada fila se convertir√° en una acta independiente'],
                ['4. Los nombres de columnas son flexibles (no importan may√∫sculas)'],
                ['5. Guarda el archivo y s√∫belo en la aplicaci√≥n'],
                [''],
                ['FORMATOS ACEPTADOS:'],
                ['‚Ä¢ Fechas: YYYY-MM-DD (ej: 2024-12-25) o formato Excel'],
                ['‚Ä¢ N√∫meros: Solo d√≠gitos (ej: 45.75 para precios)'],
                ['‚Ä¢ V√≠a: "maritimo" o "aereo"'],
                [''],
                ['COLUMNAS REQUERIDAS:'],
                ['‚Ä¢ Fecha - Fecha del acta'],
                ['‚Ä¢ Ciudad - Ciudad de destino'],
                ['‚Ä¢ Agente - Nombre del agente/cliente'],
                [''],
                ['COLUMNAS OPCIONALES:'],
                ['‚Ä¢ Modelo Camion, A√±o Camion, Placa'],
                ['‚Ä¢ Chofer, Telefono Chofer'],
                ['‚Ä¢ Ayudante, Telefono Ayudante'],
                ['‚Ä¢ No Guia, Cliente, Direccion, Telefono'],
                ['‚Ä¢ Bultos, Pies, Kgs, Via, Subtotal'],
                [''],
                ['üí° TIP: Si incluyes datos de gu√≠a (No Guia, Cliente, etc.),'],
                ['   se crear√° autom√°ticamente una gu√≠a por cada acta.']
            ];

            // Crear workbook
            const wb = XLSX.utils.book_new();

            // Agregar hoja de instrucciones
            const wsInstrucciones = XLSX.utils.aoa_to_sheet(instrucciones);
            XLSX.utils.book_append_sheet(wb, wsInstrucciones, "Instrucciones");

            // Agregar hoja de actas con headers y ejemplos
            const datosActas = [headers, ...ejemplos];
            const wsActas = XLSX.utils.aoa_to_sheet(datosActas);

            // Configurar ancho de columnas
            const colWidths = [
                {wch: 12}, {wch: 15}, {wch: 20}, {wch: 18}, {wch: 12}, {wch: 12},
                {wch: 18}, {wch: 15}, {wch: 18}, {wch: 15},
                {wch: 15}, {wch: 20}, {wch: 30}, {wch: 15}, {wch: 8}, {wch: 8}, {wch: 8}, {wch: 10}, {wch: 10}
            ];
            wsActas['!cols'] = colWidths;

            // Estilo para los headers (primera fila)
            const headerStyle = {
                fill: { fgColor: { rgb: "28a745" } },
                font: { bold: true, color: { rgb: "FFFFFF" } },
                alignment: { horizontal: "center" }
            };

            XLSX.utils.book_append_sheet(wb, wsActas, "Actas");

            // Generar archivo y descargarlo
            const fileName = `Plantilla_Actas_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, fileName);

            alert('üì• ¬°Plantilla Excel descargada!\n\n' +
                  '‚úÖ Archivo: ' + fileName + '\n' +
                  'üìã Incluye: Instrucciones + 3 ejemplos\n' +
                  'üí° Llena tus datos y s√∫belo a la aplicaci√≥n');
        }
    </script>
</body>
</html> 